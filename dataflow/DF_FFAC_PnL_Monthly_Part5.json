{
	"name": "DF_FFAC_PnL_Monthly_Part5",
	"properties": {
		"folder": {
			"name": "FFAC"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "DS_ADW_Parameterized_Prod",
						"type": "DatasetReference"
					},
					"name": "SrcFacilitiesMapping"
				},
				{
					"dataset": {
						"referenceName": "DS_ADW_Parameterized_Prod",
						"type": "DatasetReference"
					},
					"name": "SrcOrgLawsonMapping"
				},
				{
					"dataset": {
						"referenceName": "DS_ADW_Parameterized_Prod",
						"type": "DatasetReference"
					},
					"name": "SrcOrgOracleMapping"
				},
				{
					"dataset": {
						"referenceName": "DS_ADW_Snk_FFAC_PnL_Sap_ITT_Intermediate_Part4",
						"type": "DatasetReference"
					},
					"name": "SrcSapITTIntermediate"
				},
				{
					"dataset": {
						"referenceName": "DS_ADW_Snk_FFAC_PnL_Lawson_Part2",
						"type": "DatasetReference"
					},
					"name": "SrcLawsonPart1"
				},
				{
					"dataset": {
						"referenceName": "DS_ADW_Snk_FFAC_PnL_Oracle_Part3",
						"type": "DatasetReference"
					},
					"name": "SrcOraclePart2"
				},
				{
					"dataset": {
						"referenceName": "DS_ADW_Snk_FFAC_PnL_SAP_ITT_Part4",
						"type": "DatasetReference"
					},
					"name": "SrcSapITTPart3"
				},
				{
					"dataset": {
						"referenceName": "DS_ADW_Parameterized_Prod",
						"type": "DatasetReference"
					},
					"name": "SrcNISStandard"
				},
				{
					"dataset": {
						"referenceName": "DS_ADW_Parameterized_Prod",
						"type": "DatasetReference"
					},
					"name": "SrcNonFacMapping"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DS_ADW_Snk_FFAC_Stg_Facilities_Temp",
						"type": "DatasetReference"
					},
					"name": "SnkStgFFACFacilitiesTemp",
					"rejectedDataLinkedService": {
						"referenceName": "LS_NGBS_StagingBLOB",
						"type": "LinkedServiceReference"
					}
				}
			],
			"transformations": [
				{
					"name": "FltNotNullERP"
				},
				{
					"name": "DerColUpperCaseERP"
				},
				{
					"name": "FltGeomarketCodeLawson"
				},
				{
					"name": "AggGrpbyFields"
				},
				{
					"name": "SelReqFieldsLawson"
				},
				{
					"name": "FltERPLawson"
				},
				{
					"name": "JnrFacilitiesandLawsonMapping"
				},
				{
					"name": "ExsFacilityandLawsonMapping"
				},
				{
					"name": "SelRemoveAccountUnitCode"
				},
				{
					"name": "FltERPOracle"
				},
				{
					"name": "FltGeomarketCodeOracle"
				},
				{
					"name": "AggGrpbyOracle"
				},
				{
					"name": "SelReqFieldsOracle"
				},
				{
					"name": "DerColERPUID"
				},
				{
					"name": "JnrFacilityandOracle"
				},
				{
					"name": "ExsFaciltyandOracleMapping"
				},
				{
					"name": "SelRemoveFieldsOracle"
				},
				{
					"name": "FltERPSAPITT"
				},
				{
					"name": "DerColERPUIDSPEND"
				},
				{
					"name": "AggGrpbySAPITT"
				},
				{
					"name": "SelReqFieldsSAPITT"
				},
				{
					"name": "JnrFacilityandSAPITT"
				},
				{
					"name": "ExsFactilityandSAPITT"
				},
				{
					"name": "UnAllOutputs"
				},
				{
					"name": "DerColReplaceNull"
				},
				{
					"name": "AggGrpbyFinalFields"
				},
				{
					"name": "SelGrpbyFields"
				},
				{
					"name": "DerColDataForField"
				},
				{
					"name": "UnLawsonOracleSAP"
				},
				{
					"name": "SelRenameSapITTFields"
				},
				{
					"name": "SelRenameOracleFields"
				},
				{
					"name": "SelRenameLawsonFields"
				},
				{
					"name": "DerColConverttoString"
				},
				{
					"name": "DerColConverttoStringOracle"
				},
				{
					"name": "SelReqUnionFields"
				},
				{
					"name": "DerColMutliCol"
				},
				{
					"name": "JnDerColandSrcNISStandard"
				},
				{
					"name": "SelRemoveJoinFields"
				},
				{
					"name": "DerColConverttoInt"
				},
				{
					"name": "JnFltwithNonFFAC"
				},
				{
					"name": "SelRemoveJoinFieldsNonFacMapping"
				},
				{
					"name": "ExsNonFacMapping"
				},
				{
					"name": "ConditionalSplit1"
				},
				{
					"name": "UnAllInputs"
				},
				{
					"name": "SrtbyDataForandYearMonth"
				},
				{
					"name": "SelFInalColumns"
				}
			],
			"script": "source(output(\n\t\tERP as string,\n\t\t{ERP UID SPEND} as string,\n\t\t{ERP UID ZEROIZATION} as string,\n\t\t{Facility ID} as string,\n\t\t{Facility Name} as string,\n\t\t{Facility Status} as string,\n\t\t{Facility Type} as string,\n\t\t{Facility Owner} as string,\n\t\t{Business Activity} as string,\n\t\t{Origin Business} as string,\n\t\t{FDE-Country} as string,\n\t\t{FDE-City} as string,\n\t\tLatitude as double,\n\t\tLongitude as double,\n\t\t{Land Area Square Meter} as decimal(25,0),\n\t\t{Build Area Square Meter} as decimal(25,0)\n\t),\n\tallowSchemaDrift: false,\n\tvalidateSchema: true,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'SELECT [ERP]\\n      ,[ERP UID SPEND]\\n      ,[ERP UID ZEROIZATION]\\n      ,[Facility ID]\\n      ,[Facility Name]\\n      ,[Facility Status]\\n      ,[Facility Type]\\n      ,[Facility Owner]\\n      ,[Business Activity]\\n      ,[Origin Business]\\n      ,[FDE-Country]\\n      ,[FDE-City]\\n      ,[Latitude]\\n      ,[Longitude]\\n      ,Convert(numeric(25,0),[Land Area Square Meter]) as [Land Area Square Meter]\\n      ,Convert(numeric(25,0),[Build Area Square Meter]) as [Build Area Square Meter]\\n  FROM [SSO_SHAREPOINT_SOURCE].[SRC_FI_SPO_FSPO_FFACFacMapping]',\n\tformat: 'query',\n\tstaged: true) ~> SrcFacilitiesMapping\nsource(output(\n\t\t{Accounting Unit (Code)} as string,\n\t\t{Accounting Unit (Desc)} as string,\n\t\t{Company (Code)} as decimal(4,0),\n\t\t{Company (Desc)} as string,\n\t\t{Product Line Group (Code)} as string,\n\t\t{Product Line Group (Desc)} as string,\n\t\t{SL Product Line Group (Code)} as string,\n\t\t{SL Product Line Group (Desc)} as string,\n\t\t{Product Line (Code)} as string,\n\t\t{Product Line (Desc)} as string,\n\t\t{SL Product Line (Code)} as string,\n\t\t{SL Product Line (Desc)} as string,\n\t\t{SL Sub Product Line (Code)} as string,\n\t\t{SL Sub Product Line (Desc)} as string,\n\t\t{Sub Product Line (Code)} as string,\n\t\t{Sub Product Line (Desc)} as string,\n\t\t{Sub Sub Product Line(Code)} as string,\n\t\t{Sub Sub Product Line(Desc)} as string,\n\t\t{Area (Code)} as string,\n\t\t{Area (Desc)} as string,\n\t\t{Geomarket (Code)} as string,\n\t\t{Geomarket (Desc)} as string,\n\t\t{Mgmt Country (Code)} as string,\n\t\t{Mgmt Country (Desc)} as string,\n\t\t{SL Area (Code)} as string,\n\t\t{SL Area (Desc)} as string,\n\t\t{SL Geomarket (Code)} as string,\n\t\t{SL Geomarket (Desc)} as string,\n\t\t{SL Hemisphere (Code)} as string,\n\t\t{SL Hemisphere (Desc)} as string,\n\t\t{Sub Geomarket (Code)} as string,\n\t\t{Sub Geomarket (Desc)} as string,\n\t\t{Amount CM} as decimal(38,2),\n\t\tSYS_CreatedBy as string,\n\t\tSYS_CreatedDate as timestamp\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'Select * From [SSO_REPORTER_SOURCE].[SRC_Org_mapping_Lawson]',\n\tformat: 'query',\n\tstaged: true) ~> SrcOrgLawsonMapping\nsource(output(\n\t\t{Product Line Group (Code)} as string,\n\t\t{Product Line Group (Desc)} as string,\n\t\t{SL Product Line Group (Code)} as string,\n\t\t{SL Product Line Group (Desc)} as string,\n\t\t{Business Line (Desc)} as string,\n\t\t{Business Line} as string,\n\t\t{Product Line (Code)} as string,\n\t\t{Product Line (Desc)} as string,\n\t\t{SL Product Line (Code)} as string,\n\t\t{SL Product Line (Desc)} as string,\n\t\t{SL Sub Product Line (Code)} as string,\n\t\t{SL Sub Product Line (Desc)} as string,\n\t\t{Sub Product Line (Code)} as string,\n\t\t{Sub Product Line (Desc)} as string,\n\t\t{Sub Sub Product Line (Code)} as string,\n\t\t{Sub Sub Product Line (Desc)} as string,\n\t\t{Cost Center (Code)} as string,\n\t\t{Cost Center (Desc)} as string,\n\t\t{Country (Code)} as string,\n\t\t{Country (Desc)} as string,\n\t\t{SL Area (Code)} as string,\n\t\t{SL Area (Desc)} as string,\n\t\t{SL Geomarket (Code)} as string,\n\t\t{SL Geomarket (Desc)} as string,\n\t\t{SL Hemisphere (Code)} as string,\n\t\t{SL Hemisphere (Desc)} as string,\n\t\t{SL Sub Geomarket (Code)} as string,\n\t\t{SL Sub Geomarket (Desc)} as string,\n\t\tSYS_CreatedBy as string,\n\t\tSYS_CreatedDate as timestamp\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'Select * From [SSO_REPORTER_SOURCE].[SRC_Org_mapping_Oracle]',\n\tformat: 'query',\n\tstaged: true) ~> SrcOrgOracleMapping\nsource(output(\n\t\tProduct_Line_Code as string,\n\t\tProduct_Line_Group_Code as string,\n\t\tProfit_Center_Code as string,\n\t\tSL_Product_Line_Code as string,\n\t\tSL_Product_Line_Desc as string,\n\t\tSL_Product_Line_Group_Code as string,\n\t\tSL_Product_Line_Group_Desc as string,\n\t\tSL_Sub_Product_Line_Code as string,\n\t\tSL_Sub_Product_Line_Desc as string,\n\t\tSub_Product_Line_Code as string,\n\t\tArea_Code as string,\n\t\tGeomarket_Code as string,\n\t\tSL_Area_Code as string,\n\t\tSL_Area_Desc as string,\n\t\tSL_Geomarket_Code as string,\n\t\tSL_Geomarket_Desc as string,\n\t\tSL_Hemisphere_Code as string,\n\t\tSL_Hemisphere_Desc as string,\n\t\tSub_Geomarket_Code as string,\n\t\tSYS_CreatedBy as string,\n\t\tSYS_CreatedDate as timestamp,\n\t\tCountry_Code as string,\n\t\tCountry_Desc as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'Select * from NGBS.FFAC_PnL_SAP_ITT_Intermediate_Temp_Part4',\n\tformat: 'query',\n\tstaged: true) ~> SrcSapITTIntermediate\nsource(output(\n\t\tCCAU as string,\n\t\tCCAUDesc as string,\n\t\tNIS_Desc as string,\n\t\tAccount as string,\n\t\tSubAccount as string,\n\t\tAccountDesc as string,\n\t\tYear as string,\n\t\tMonth as string,\n\t\tUpdateDate as date,\n\t\tSeqTrnsNbr as string,\n\t\tPostingDate as date,\n\t\tActivity as string,\n\t\tSourceCode as string,\n\t\tSystem as string,\n\t\tJournal as string,\n\t\tLineNbr as string,\n\t\tOperator as string,\n\t\tReference as string,\n\t\tDescription as string,\n\t\tCurrencyCode as string,\n\t\tTranAmount as string,\n\t\tBaseAmount as string,\n\t\tVendor as string,\n\t\tVendorVname as string,\n\t\tInvoiceNo as string,\n\t\tPoNumber as string,\n\t\tURN as string,\n\t\tCompany as string,\n\t\tCompany_Desc as string,\n\t\tProduct_Line_Group_Code as string,\n\t\tSL_Product_Line_Group_Code as string,\n\t\tProduct_Line_Code as string,\n\t\tSL_Product_Line_Code as string,\n\t\tSL_Sub_Product_Line_Code as string,\n\t\tSub_Product_Line_Code as string,\n\t\tSub_Sub_Product_Line_Code as string,\n\t\tMgmt_Country_Code as string,\n\t\tCountryDesc as string,\n\t\tSL_Area_Code as string,\n\t\tSL_Geomarket_Code as string,\n\t\tSL_Hemisphere_Code as string,\n\t\tSL_Hemisphere_Desc as string,\n\t\tSub_Geomarket_Code as string,\n\t\tERP_UID_SPEND as string,\n\t\tERP_UID_ZEROIZATION as string,\n\t\tSubAccnt_Minor as string,\n\t\tNIS_Sub_Line as string,\n\t\tERP_UID as string,\n\t\tFacility_ID as string,\n\t\tFacility_Name as string,\n\t\tFacility_Status as string,\n\t\tFacility_Type as string,\n\t\tFacility_Owner as string,\n\t\tLatitude as double,\n\t\tLongitude as double,\n\t\tOrigin_Business as string,\n\t\tBusiness_Activity as string,\n\t\tERP as string,\n\t\tFDE_Country as string,\n\t\tFDE_City as string,\n\t\tLand_Area_Square_Meter as decimal(24,0),\n\t\tBuild_Area_Square_Meter as decimal(24,0),\n\t\tAccount_Type as string,\n\t\tGL_Account as string,\n\t\tAccount_Desc as string,\n\t\tFacility_Assigned as string,\n\t\tExcludeCountry as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'Select * from NGBS.FFAC_PnL_Lawson_Temp_Part2',\n\tformat: 'query',\n\tstaged: true) ~> SrcLawsonPart1\nsource(output(\n\t\tCountry_Desc as string,\n\t\tCompany as string,\n\t\tCompany_Desc as string,\n\t\tCCAUDesc as string,\n\t\tAccount as string,\n\t\tAccountDesc as string,\n\t\tSubAccount as string,\n\t\tLocal as string,\n\t\tDocument_Number as string,\n\t\tGL_DATE as date,\n\t\tPostingDate as date,\n\t\tOperator as string,\n\t\tInvoiceNo as string,\n\t\tJournal as string,\n\t\tDescription as string,\n\t\tSourceCode as string,\n\t\tPoNumber as string,\n\t\tBaseAmount as double,\n\t\tSystem as string,\n\t\tTranAmount as double,\n\t\tCurrencyCode as string,\n\t\tURN as string,\n\t\tVendor as string,\n\t\tVendorVname as string,\n\t\tLineNbr as string,\n\t\tSOURCE_SYSTEM as string,\n\t\tSYS_CreatedBy as string,\n\t\tSYS_CreatedDate as timestamp,\n\t\tProduct_Line_Group_Code as string,\n\t\tSL_Product_Line_Group_Code as string,\n\t\tBusiness_Line as string,\n\t\tProduct_Line_Code as string,\n\t\tSL_Product_Line_Code as string,\n\t\tSL_Sub_Product_Line_Code as string,\n\t\tSub_Product_Line_Code as string,\n\t\tSub_Sub_Product_Line_Code as string,\n\t\tCCAU as string,\n\t\tMgmt_Country_Code as string,\n\t\tSL_Area_Code as string,\n\t\tSL_Geomarket_Code as string,\n\t\tSL_Hemisphere_Code as string,\n\t\tSL_Hemisphere_Desc as string,\n\t\tSub_Geomarket_Code as string,\n\t\tRight_SYS_CreatedBy as string,\n\t\tRight_SYS_CreatedDate as timestamp,\n\t\tSubAccnt_Minor as string,\n\t\tYear as string,\n\t\tMonth as string,\n\t\tERP_Data as string,\n\t\tERP_UID_SPEND as string,\n\t\tERP_UID_ZEROIZATION as string,\n\t\tNIS_Desc as string,\n\t\tSys_CreatedBy2 as string,\n\t\tSys_CreatedDate2 as timestamp,\n\t\tNIS_Sub_Line as string,\n\t\tERP_UID as string,\n\t\tFacility_ID as string,\n\t\tFacility_Name as string,\n\t\tFacility_Status as string,\n\t\tFacility_Type as string,\n\t\tFacility_Owner as string,\n\t\tLatitude as double,\n\t\tLongitude as double,\n\t\tOrigin_Business as string,\n\t\tBusiness_Activity as string,\n\t\tERP as string,\n\t\tFDE_Country as string,\n\t\tFDE_City as string,\n\t\tLand_Area_Square_Meter as decimal(24,0),\n\t\tBuild_Area_Square_Meter as decimal(24,0),\n\t\tAccount_Type as string,\n\t\tGL_Account as string,\n\t\tAccount_Desc as string,\n\t\tFacility_Assigned as string,\n\t\tExcludeCountry as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'Select * from NGBS.FFAC_PnL_Oracle_Temp_Part3',\n\tformat: 'query',\n\tstaged: true) ~> SrcOraclePart2\nsource(output(\n\t\tTranAmount as double,\n\t\tBaseAmount as double,\n\t\tVendorVname as string,\n\t\tVendor as string,\n\t\tCurrencyCode as string,\n\t\tSystem as string,\n\t\tSourceCode as string,\n\t\tPoNumber as string,\n\t\tInvoiceNo as string,\n\t\tPostingDate as timestamp,\n\t\tJournal as string,\n\t\tDescription as string,\n\t\tLineNbr as long,\n\t\tCompany_Desc as string,\n\t\tCompany as string,\n\t\tCountryDesc as string,\n\t\tMgmt_Country_Code as string,\n\t\tAccount as string,\n\t\tAccountDesc as string,\n\t\tNIS_Desc as string,\n\t\tProfit_Center_Desc as string,\n\t\tProfit_Center as string,\n\t\tCCAU as string,\n\t\tCCAU_Desc as string,\n\t\tUser_Gin as string,\n\t\tReversed_Flag as string,\n\t\tReference_Document as string,\n\t\tTransaction_Code as string,\n\t\tTransaction_Code_Description as string,\n\t\tLDAP_User_Alias as string,\n\t\tProduct_Line_Code as string,\n\t\tProduct_Line_Group_Code as string,\n\t\tSL_Product_Line_Code as string,\n\t\tSL_Product_Line_Group_Code as string,\n\t\tSL_Sub_Product_Line_Code as string,\n\t\tSub_Product_Line_Code as string,\n\t\tSL_Area_Code as string,\n\t\tSL_Geomarket_Code as string,\n\t\tSL_Hemisphere_Code as string,\n\t\tSL_Hemisphere_Desc as string,\n\t\tSub_Geomarket_Code as string,\n\t\tSYS_CreatedBy as string,\n\t\tSYS_CreatedDate as timestamp,\n\t\tCountry_Code as string,\n\t\tRight_Country_Desc as string,\n\t\tSubAccnt_Minor as string,\n\t\tYear as string,\n\t\tMonth as string,\n\t\tERP_Data as string,\n\t\tERP_UID_SPEND as string,\n\t\tERP_UID_ZEROIZATION as string,\n\t\tNIS_SubLine as string,\n\t\tERP_UID as string,\n\t\tFacility_ID as string,\n\t\tFacility_Name as string,\n\t\tFacility_Status as string,\n\t\tFacility_Type as string,\n\t\tFacility_Owner as string,\n\t\tLatitude as double,\n\t\tLongitude as double,\n\t\tOrigin_Business as string,\n\t\tBusiness_Activity as string,\n\t\tERP as string,\n\t\tFDE_Country as string,\n\t\tFDE_City as string,\n\t\tLand_Area_Square_Meter as decimal(24,0),\n\t\tBuild_Area_Square_Meter as decimal(24,0),\n\t\tAccount_Type as string,\n\t\tGL_Account as string,\n\t\tAccount_Desc as string,\n\t\tFacility_Assigned as string,\n\t\tExcludeCountry as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'Select * from NGBS.FFAC_PnL_SapITT_Temp_Part4',\n\tformat: 'query',\n\tstaged: true) ~> SrcSapITTPart3\nsource(output(\n\t\tTitle as string,\n\t\t{Nis Description} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'Select Title,[Nis Description] From [SSO_SHAREPOINT_SOURCE].[SRC_FI_SPO_FSPO_FOHCNISStandard]',\n\tformat: 'query',\n\tstaged: true) ~> SrcNISStandard\nsource(output(\n\t\tERP as string,\n\t\tAUCC as string,\n\t\t{FDE-Country} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'Select ERP,[AU/CC] as AUCC,[FDE-Country] From [SSO_SHAREPOINT_SOURCE].[SRC_FI_SPO_FSPO_FFACNonFacMapping]',\n\tformat: 'query',\n\tstaged: true) ~> SrcNonFacMapping\nSrcFacilitiesMapping filter(!isNull(ERP)) ~> FltNotNullERP\nFltNotNullERP derive(ERP = upper(ERP)) ~> DerColUpperCaseERP\nSrcOrgLawsonMapping filter({SL Geomarket (Code)} != 'N/A') ~> FltGeomarketCodeLawson\nFltGeomarketCodeLawson aggregate(groupBy({Accounting Unit (Code)},\n\t\t{SL Hemisphere (Code)},\n\t\t{SL Area (Code)},\n\t\t{SL Geomarket (Code)},\n\t\t{Sub Geomarket (Code)},\n\t\t{Product Line (Code)},\n\t\t{Mgmt Country (Code)},\n\t\t{Mgmt Country (Desc)}),\n\tCountID = count({Accounting Unit (Code)})) ~> AggGrpbyFields\nAggGrpbyFields select(mapColumn(\n\t\t{Accounting Unit (Code)},\n\t\t{SL Hemisphere (Code)},\n\t\t{SL Area (Code)},\n\t\t{SL Geomarket (Code)},\n\t\t{Sub Geomarket (Code)},\n\t\t{Product Line (Code)},\n\t\t{Mgmt Country (Code)},\n\t\tCountry_Desc = {Mgmt Country (Desc)}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelReqFieldsLawson\nDerColUpperCaseERP filter(ERP == 'LAWSON') ~> FltERPLawson\nFltERPLawson, SelReqFieldsLawson join({ERP UID SPEND} == {Accounting Unit (Code)},\n\tjoinType:'inner',\n\tmatchType:'exact',\n\tignoreSpaces: false,\n\tbroadcast: 'auto')~> JnrFacilitiesandLawsonMapping\nFltERPLawson, SelReqFieldsLawson exists({ERP UID SPEND} == {Accounting Unit (Code)},\n\tnegate:true,\n\tbroadcast: 'auto')~> ExsFacilityandLawsonMapping\nJnrFacilitiesandLawsonMapping select(mapColumn(\n\t\tERP,\n\t\t{ERP UID SPEND},\n\t\t{ERP UID ZEROIZATION},\n\t\t{Facility ID},\n\t\t{Facility Name},\n\t\t{Facility Status},\n\t\t{Facility Type},\n\t\t{Facility Owner},\n\t\t{Business Activity},\n\t\t{Origin Business},\n\t\t{FDE-Country},\n\t\t{FDE-City},\n\t\tLatitude,\n\t\tLongitude,\n\t\t{Land Area Square Meter},\n\t\t{Build Area Square Meter},\n\t\t{SL Hemisphere (Code)},\n\t\t{SL Area (Code)},\n\t\t{SL Geomarket (Code)},\n\t\t{Sub Geomarket (Code)},\n\t\t{Product Line (Code)},\n\t\t{Mgmt Country (Code)},\n\t\tCountryDesc = Country_Desc\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelRemoveAccountUnitCode\nDerColUpperCaseERP filter(in(['ORACLE-MI','ORACLE-SI'], ERP)) ~> FltERPOracle\nSrcOrgOracleMapping filter({SL Geomarket (Code)} != 'N/A') ~> FltGeomarketCodeOracle\nFltGeomarketCodeOracle aggregate(groupBy({Cost Center (Code)},\n\t\t{Business Line},\n\t\t{SL Hemisphere (Code)},\n\t\t{SL Area (Code)},\n\t\t{SL Geomarket (Code)},\n\t\t{SL Sub Geomarket (Code)},\n\t\t{Product Line (Code)},\n\t\t{Country (Code)},\n\t\t{Country (Desc)}),\n\tCountID = count({Country (Code)})) ~> AggGrpbyOracle\nAggGrpbyOracle select(mapColumn(\n\t\t{Cost Center (Code)},\n\t\t{Business Line},\n\t\t{SL Hemisphere (Code)},\n\t\t{SL Area (Code)},\n\t\t{SL Geomarket (Code)},\n\t\t{Sub Geomarket (Code)} = {SL Sub Geomarket (Code)},\n\t\t{Product Line (Code)},\n\t\tMgmt_Country_Code = {Country (Code)},\n\t\tCountryDesc = {Country (Desc)}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelReqFieldsOracle\nSelReqFieldsOracle derive(ERP_UID = {Cost Center (Code)}) ~> DerColERPUID\nFltERPOracle, DerColERPUID join({ERP UID SPEND} == ERP_UID,\n\tjoinType:'inner',\n\tmatchType:'exact',\n\tignoreSpaces: false,\n\tbroadcast: 'auto')~> JnrFacilityandOracle\nFltERPOracle, DerColERPUID exists({ERP UID SPEND} == ERP_UID,\n\tnegate:true,\n\tbroadcast: 'auto')~> ExsFaciltyandOracleMapping\nJnrFacilityandOracle select(mapColumn(\n\t\tERP,\n\t\t{ERP UID SPEND},\n\t\t{ERP UID ZEROIZATION},\n\t\t{Facility ID},\n\t\t{Facility Name},\n\t\t{Facility Status},\n\t\t{Facility Type},\n\t\t{Facility Owner},\n\t\t{Business Activity},\n\t\t{Origin Business},\n\t\t{FDE-Country},\n\t\t{FDE-City},\n\t\tLatitude,\n\t\tLongitude,\n\t\t{Land Area Square Meter},\n\t\t{Build Area Square Meter},\n\t\t{SL Hemisphere (Code)},\n\t\t{SL Area (Code)},\n\t\t{SL Geomarket (Code)},\n\t\t{Sub Geomarket (Code)},\n\t\t{Product Line (Code)},\n\t\t{Mgmt Country (Code)} = Mgmt_Country_Code,\n\t\tCountryDesc\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelRemoveFieldsOracle\nDerColUpperCaseERP filter(ERP == 'SAP ITT') ~> FltERPSAPITT\nFltERPSAPITT derive({ERP UID SPEND} = substring({ERP UID SPEND},3,6)) ~> DerColERPUIDSPEND\nSrcSapITTIntermediate aggregate(groupBy(Profit_Center_Code,\n\t\tSL_Hemisphere_Code,\n\t\tSL_Area_Code,\n\t\tSL_Geomarket_Code,\n\t\tSub_Geomarket_Code),\n\tCountID = count(Profit_Center_Code)) ~> AggGrpbySAPITT\nAggGrpbySAPITT select(mapColumn(\n\t\t{Profit Center (Code)} = Profit_Center_Code,\n\t\t{SL Hemisphere (Code)} = SL_Hemisphere_Code,\n\t\t{SL Area (Code)} = SL_Area_Code,\n\t\t{SL Geomarket (Code)} = SL_Geomarket_Code,\n\t\t{Sub Geomarket (Code)} = Sub_Geomarket_Code\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelReqFieldsSAPITT\nDerColERPUIDSPEND, SelReqFieldsSAPITT join({ERP UID SPEND} == {Profit Center (Code)},\n\tjoinType:'inner',\n\tmatchType:'exact',\n\tignoreSpaces: false,\n\tbroadcast: 'auto')~> JnrFacilityandSAPITT\nDerColERPUIDSPEND, SelReqFieldsSAPITT exists({ERP UID SPEND} == {Profit Center (Code)},\n\tnegate:true,\n\tbroadcast: 'auto')~> ExsFactilityandSAPITT\nSelRemoveAccountUnitCode, ExsFacilityandLawsonMapping, SelRemoveFieldsOracle, ExsFaciltyandOracleMapping, JnrFacilityandSAPITT, ExsFactilityandSAPITT union(byName: true)~> UnAllOutputs\nUnAllOutputs derive(each(match(in(['SL Hemisphere (Code)','SL Area (Code)','SL Geomarket (Code)','Product Line (Code)','Mgmt Country (Code)'],name)), $$ = iifNull($$,'N/A',$$))) ~> DerColReplaceNull\nDerColReplaceNull aggregate(groupBy({Facility ID},\n\t\t{Facility Name},\n\t\t{Facility Status},\n\t\t{Facility Type},\n\t\t{Facility Owner},\n\t\tLatitude,\n\t\tLongitude,\n\t\t{Origin Business},\n\t\t{Business Activity},\n\t\tERP,\n\t\t{SL Hemisphere (Code)},\n\t\t{SL Area (Code)},\n\t\t{SL Geomarket (Code)},\n\t\t{Sub Geomarket (Code)},\n\t\t{Product Line (Code)},\n\t\t{Mgmt Country (Code)},\n\t\t{ERP UID SPEND},\n\t\t{ERP UID ZEROIZATION},\n\t\t{FDE-Country},\n\t\t{FDE-City}),\n\tCountID = count(ERP)) ~> AggGrpbyFinalFields\nAggGrpbyFinalFields select(mapColumn(\n\t\tFacility_ID = {Facility ID},\n\t\tFacility_Name = {Facility Name},\n\t\tFacility_Status = {Facility Status},\n\t\tFacility_Type = {Facility Type},\n\t\tFacility_Owner = {Facility Owner},\n\t\tLatitude,\n\t\tLongitude,\n\t\tOrigin_Business = {Origin Business},\n\t\tBusiness_Activity = {Business Activity},\n\t\tERP,\n\t\tSL_Hemisphere_Code = {SL Hemisphere (Code)},\n\t\tSL_Area_Code = {SL Area (Code)},\n\t\tSL_Geomarket_Code = {SL Geomarket (Code)},\n\t\tSub_Geomarket_Code = {Sub Geomarket (Code)},\n\t\tProduct_Line_Code = {Product Line (Code)},\n\t\tMgmt_Country_Code = {Mgmt Country (Code)},\n\t\tERP_UID_SPEND = {ERP UID SPEND},\n\t\tERP_UID_ZEROIZATION = {ERP UID ZEROIZATION},\n\t\tFDE_Country = {FDE-Country},\n\t\tFDE_City = {FDE-City}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelGrpbyFields\nSelGrpbyFields derive(DataFor = 'Mapping') ~> DerColDataForField\nSelRenameSapITTFields, SelRenameOracleFields, SelRenameLawsonFields union(byName: true)~> UnLawsonOracleSAP\nDerColConverttoString select(mapColumn(\n\t\tTranAmount,\n\t\tBaseAmount,\n\t\tVendorVname,\n\t\tVendor,\n\t\tCurrencyCode,\n\t\tSystem,\n\t\tSourceCode,\n\t\tPoNumber,\n\t\tInvoiceNo,\n\t\tPostingDate,\n\t\tJournal,\n\t\tDescription,\n\t\tLineNbr,\n\t\tCompany_Desc,\n\t\tCompany,\n\t\tCountryDesc,\n\t\tMgmt_Country_Code,\n\t\tAccount,\n\t\tAccountDesc,\n\t\tNIS_Desc,\n\t\tProfit_Center_Desc,\n\t\tProfit_Center,\n\t\tCCAU,\n\t\tCCAUDesc = CCAU_Desc,\n\t\tUser_Gin,\n\t\tReversed_Flag,\n\t\tReference_Document,\n\t\tTransaction_Code,\n\t\tTransaction_Code_Description,\n\t\tLDAP_User_Alias,\n\t\tProduct_Line_Code,\n\t\tProduct_Line_Group_Code,\n\t\tSL_Product_Line_Code,\n\t\tSL_Product_Line_Group_Code,\n\t\tSL_Sub_Product_Line_Code,\n\t\tSub_Product_Line_Code,\n\t\tSL_Area_Code,\n\t\tSL_Geomarket_Code,\n\t\tSL_Hemisphere_Code,\n\t\tSL_Hemisphere_Desc,\n\t\tSub_Geomarket_Code,\n\t\tSYS_CreatedBy,\n\t\tSYS_CreatedDate,\n\t\tCountry_Code,\n\t\tRight_Country_Desc,\n\t\tSubAccnt_Minor,\n\t\tYear,\n\t\tMonth,\n\t\tERP_Data,\n\t\tERP_UID_SPEND,\n\t\tERP_UID_ZEROIZATION,\n\t\tNIS_Sub_Line = NIS_SubLine,\n\t\tERP_UID,\n\t\tFacility_ID,\n\t\tFacility_Name,\n\t\tFacility_Status,\n\t\tFacility_Type,\n\t\tFacility_Owner,\n\t\tLatitude,\n\t\tLongitude,\n\t\tOrigin_Business,\n\t\tBusiness_Activity,\n\t\tERP,\n\t\tFDE_Country,\n\t\tFDE_City,\n\t\tLand_Area_Square_Meter,\n\t\tBuild_Area_Square_Meter,\n\t\tAccount_Type,\n\t\tGL_Account,\n\t\tAccount_Desc,\n\t\tFacility_Assigned,\n\t\tExcludeCountry\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelRenameSapITTFields\nDerColConverttoStringOracle select(mapColumn(\n\t\tCountryDesc = Country_Desc,\n\t\tCompany,\n\t\tCompany_Desc,\n\t\tCCAUDesc,\n\t\tAccount,\n\t\tAccountDesc,\n\t\tSubAccount,\n\t\tLocal,\n\t\tDocument_Number,\n\t\tGL_DATE,\n\t\tPostingDate,\n\t\tOperator,\n\t\tInvoiceNo,\n\t\tJournal,\n\t\tDescription,\n\t\tSourceCode,\n\t\tPoNumber,\n\t\tBaseAmount,\n\t\tSystem,\n\t\tTranAmount,\n\t\tCurrencyCode,\n\t\tURN,\n\t\tVendor,\n\t\tVendorVname,\n\t\tLineNbr,\n\t\tSource_System = SOURCE_SYSTEM,\n\t\tSYS_CreatedBy,\n\t\tSYS_CreatedDate,\n\t\tProduct_Line_Group_Code,\n\t\tSL_Product_Line_Group_Code,\n\t\tBusiness_Line,\n\t\tProduct_Line_Code,\n\t\tSL_Product_Line_Code,\n\t\tSL_Sub_Product_Line_Code,\n\t\tSub_Product_Line_Code,\n\t\tSub_Sub_Product_Line_Code,\n\t\tCCAU,\n\t\tMgmt_Country_Code,\n\t\tSL_Area_Code,\n\t\tSL_Geomarket_Code,\n\t\tSL_Hemisphere_Code,\n\t\tSL_Hemisphere_Desc,\n\t\tSub_Geomarket_Code,\n\t\tRight_SYS_CreatedBy,\n\t\tRight_SYS_CreatedDate,\n\t\tSubAccnt_Minor,\n\t\tYear,\n\t\tMonth,\n\t\tERP_Data,\n\t\tERP_UID_SPEND,\n\t\tERP_UID_ZEROIZATION,\n\t\tNIS_Desc,\n\t\tSys_CreatedBy2,\n\t\tSys_CreatedDate2,\n\t\tNIS_Sub_Line,\n\t\tERP_UID,\n\t\tFacility_ID,\n\t\tFacility_Name,\n\t\tFacility_Status,\n\t\tFacility_Type,\n\t\tFacility_Owner,\n\t\tLatitude,\n\t\tLongitude,\n\t\tOrigin_Business,\n\t\tBusiness_Activity,\n\t\tERP,\n\t\tFDE_Country,\n\t\tFDE_City,\n\t\tLand_Area_Square_Meter,\n\t\tBuild_Area_Square_Meter,\n\t\tAccount_Type,\n\t\tGL_Account,\n\t\tAccount_Desc,\n\t\tFacility_Assigned,\n\t\tExcludeCountry\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelRenameOracleFields\nSrcLawsonPart1 select(mapColumn(\n\t\tCCAU,\n\t\tCCAUDesc,\n\t\tNIS_Desc,\n\t\tAccount,\n\t\tSubAccount,\n\t\tAccountDesc,\n\t\tYear,\n\t\tMonth,\n\t\tUpdateDate,\n\t\tSeqTrnsNbr,\n\t\tPostingDate,\n\t\tActivity,\n\t\tSourceCode,\n\t\tSystem,\n\t\tJournal,\n\t\tLineNbr,\n\t\tOperator,\n\t\tReference,\n\t\tDescription,\n\t\tCurrencyCode,\n\t\tTranAmount,\n\t\tBaseAmount,\n\t\tVendor,\n\t\tVendorVname,\n\t\tInvoiceNo,\n\t\tPoNumber,\n\t\tURN,\n\t\tCompany,\n\t\tCompany_Desc,\n\t\tProduct_Line_Group_Code,\n\t\tSL_Product_Line_Group_Code,\n\t\tProduct_Line_Code,\n\t\tSL_Product_Line_Code,\n\t\tSL_Sub_Product_Line_Code,\n\t\tSub_Product_Line_Code,\n\t\tSub_Sub_Product_Line_Code,\n\t\tMgmt_Country_Code,\n\t\tCountryDesc,\n\t\tSL_Area_Code,\n\t\tSL_Geomarket_Code,\n\t\tSL_Hemisphere_Code,\n\t\tSL_Hemisphere_Desc,\n\t\tSub_Geomarket_Code,\n\t\tERP_UID_SPEND,\n\t\tERP_UID_ZEROIZATION,\n\t\tSubAccnt_Minor,\n\t\tNIS_Sub_Line,\n\t\tERP_UID,\n\t\tFacility_ID,\n\t\tFacility_Name,\n\t\tFacility_Status,\n\t\tFacility_Type,\n\t\tFacility_Owner,\n\t\tLatitude,\n\t\tLongitude,\n\t\tOrigin_Business,\n\t\tBusiness_Activity,\n\t\tERP,\n\t\tFDE_Country,\n\t\tFDE_City,\n\t\tLand_Area_Square_Meter,\n\t\tBuild_Area_Square_Meter,\n\t\tAccount_Type,\n\t\tGL_Account,\n\t\tAccount_Desc,\n\t\tFacility_Assigned,\n\t\tExcludeCountry\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelRenameLawsonFields\nSrcSapITTPart3 derive(TranAmount = toString(TranAmount),\n\t\tBaseAmount = toString(BaseAmount),\n\t\tLineNbr = toString(LineNbr),\n\t\tPostingDate = toDate(PostingDate)) ~> DerColConverttoString\nSrcOraclePart2 derive(BaseAmount = toString(BaseAmount),\n\t\tTranAmount = toString(TranAmount)) ~> DerColConverttoStringOracle\nUnLawsonOracleSAP select(mapColumn(\n\t\tTranAmount,\n\t\tBaseAmount,\n\t\tVendorVname,\n\t\tVendor,\n\t\tCurrencyCode,\n\t\tSystem,\n\t\tSourceCode,\n\t\tPoNumber,\n\t\tInvoiceNo,\n\t\tPostingDate,\n\t\tJournal,\n\t\tDescription,\n\t\tLineNbr,\n\t\tCompany_Desc,\n\t\tCompany,\n\t\tCountryDesc,\n\t\tMgmt_Country_Code,\n\t\tAccount,\n\t\tAccountDesc,\n\t\tNIS_Desc,\n\t\tProfit_Center_Desc,\n\t\tProfit_Center,\n\t\tCCAU,\n\t\tCCAUDesc,\n\t\tProduct_Line_Code,\n\t\tProduct_Line_Group_Code,\n\t\tSL_Product_Line_Code,\n\t\tSL_Product_Line_Group_Code,\n\t\tSL_Sub_Product_Line_Code,\n\t\tSub_Product_Line_Code,\n\t\tSL_Area_Code,\n\t\tSL_Geomarket_Code,\n\t\tSL_Hemisphere_Code,\n\t\tSL_Hemisphere_Desc,\n\t\tSub_Geomarket_Code,\n\t\tSubAccnt_Minor,\n\t\tYear,\n\t\tMonth,\n\t\tERP_Data,\n\t\tERP_UID_SPEND,\n\t\tERP_UID_ZEROIZATION,\n\t\tNIS_Sub_Line,\n\t\tERP_UID,\n\t\tFacility_ID,\n\t\tFacility_Name,\n\t\tFacility_Status,\n\t\tFacility_Type,\n\t\tFacility_Owner,\n\t\tLatitude,\n\t\tLongitude,\n\t\tOrigin_Business,\n\t\tBusiness_Activity,\n\t\tERP,\n\t\tFDE_Country,\n\t\tFDE_City,\n\t\tLand_Area_Square_Meter,\n\t\tBuild_Area_Square_Meter,\n\t\tAccount_Type,\n\t\tFacility_Assigned,\n\t\tSubAccount,\n\t\tLocal,\n\t\tDocument_Number,\n\t\tGL_DATE,\n\t\tOperator,\n\t\tURN,\n\t\tSource_System,\n\t\tBusiness_Line,\n\t\tSub_Sub_Product_Line_Code,\n\t\tUpdateDate,\n\t\tSeqTrnsNbr,\n\t\tActivity,\n\t\tReference\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelReqUnionFields\nSelReqUnionFields derive(YearMonth = toDate(toString(Year)+'-'+toString(Month)+'-'+'01'),\n\t\tSubAccount = iifNull(SubAccount,'0',SubAccount),\n\t\tGL_Description = iif(!isNull(Account),left(Account,8) + \"-\" + AccountDesc,Account),\n\t\tDataFor = 'PnL',\n\t\tLast_Refreshed = currentTimestamp(),\n\t\tNIS_Sub_Line = iif(isNull(NIS_Sub_Line),'',regexReplace(NIS_Sub_Line,`^([^\\s*]*\\s)`, ''))) ~> DerColMutliCol\nDerColMutliCol, SrcNISStandard join(NIS_Desc == Title,\n\tjoinType:'inner',\n\tmatchType:'exact',\n\tignoreSpaces: false,\n\tbroadcast: 'auto')~> JnDerColandSrcNISStandard\nJnDerColandSrcNISStandard select(mapColumn(\n\t\tTranAmount,\n\t\tBaseAmount,\n\t\tVendorVname,\n\t\tVendor,\n\t\tCurrencyCode,\n\t\tSystem,\n\t\tSourceCode,\n\t\tPoNumber,\n\t\tInvoiceNo,\n\t\tPostingDate,\n\t\tJournal,\n\t\tDescription,\n\t\tLineNbr,\n\t\tCompany_Desc,\n\t\tCompany,\n\t\tCountryDesc,\n\t\tMgmt_Country_Code,\n\t\tAccount,\n\t\tAccountDesc,\n\t\tProfit_Center_Desc,\n\t\tProfit_Center,\n\t\tCCAU,\n\t\tCCAUDesc,\n\t\tProduct_Line_Code,\n\t\tProduct_Line_Group_Code,\n\t\tSL_Product_Line_Code,\n\t\tSL_Product_Line_Group_Code,\n\t\tSL_Sub_Product_Line_Code,\n\t\tSub_Product_Line_Code,\n\t\tSL_Area_Code,\n\t\tSL_Geomarket_Code,\n\t\tSL_Hemisphere_Code,\n\t\tSL_Hemisphere_Desc,\n\t\tSub_Geomarket_Code,\n\t\tSubAccnt_Minor,\n\t\tYear,\n\t\tMonth,\n\t\tERP_Data,\n\t\tERP_UID_SPEND,\n\t\tERP_UID_ZEROIZATION,\n\t\tNIS_Sub_Line,\n\t\tERP_UID,\n\t\tFacility_ID,\n\t\tFacility_Name,\n\t\tFacility_Status,\n\t\tFacility_Type,\n\t\tFacility_Owner,\n\t\tLatitude,\n\t\tLongitude,\n\t\tOrigin_Business,\n\t\tBusiness_Activity,\n\t\tERP,\n\t\tFDE_Country,\n\t\tFDE_City,\n\t\tLand_Area_Square_Meter,\n\t\tBuild_Area_Square_Meter,\n\t\tAccount_Type,\n\t\tFacility_Assigned,\n\t\tSubAccount,\n\t\tLocal,\n\t\tDocument_Number,\n\t\tGL_DATE,\n\t\tOperator,\n\t\tURN,\n\t\tSource_System,\n\t\tBusiness_Line,\n\t\tSub_Sub_Product_Line_Code,\n\t\tUpdateDate,\n\t\tSeqTrnsNbr,\n\t\tActivity,\n\t\tReference,\n\t\tYearMonth,\n\t\tGL_Description,\n\t\tDataFor,\n\t\tLast_Refreshed,\n\t\t{Nis Description}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelRemoveJoinFields\nSelRemoveJoinFields derive(Year = toInteger(Year),\n\t\tMonth = toInteger(Month)) ~> DerColConverttoInt\nConditionalSplit1@FDECountryNA, SrcNonFacMapping join(ConditionalSplit1@FDECountryNA@ERP == SrcNonFacMapping@ERP\n\t&& CCAU == AUCC,\n\tjoinType:'inner',\n\tmatchType:'exact',\n\tignoreSpaces: false,\n\tbroadcast: 'auto')~> JnFltwithNonFFAC\nJnFltwithNonFFAC select(mapColumn(\n\t\tTranAmount,\n\t\tBaseAmount,\n\t\tVendorVname,\n\t\tVendor,\n\t\tCurrencyCode,\n\t\tSystem,\n\t\tSourceCode,\n\t\tPoNumber,\n\t\tInvoiceNo,\n\t\tPostingDate,\n\t\tJournal,\n\t\tDescription,\n\t\tLineNbr,\n\t\tCompany_Desc,\n\t\tCompany,\n\t\tCountryDesc,\n\t\tMgmt_Country_Code,\n\t\tAccount,\n\t\tAccountDesc,\n\t\tProfit_Center_Desc,\n\t\tProfit_Center,\n\t\tCCAU,\n\t\tCCAUDesc,\n\t\tProduct_Line_Code,\n\t\tProduct_Line_Group_Code,\n\t\tSL_Product_Line_Code,\n\t\tSL_Product_Line_Group_Code,\n\t\tSL_Sub_Product_Line_Code,\n\t\tSub_Product_Line_Code,\n\t\tSL_Area_Code,\n\t\tSL_Geomarket_Code,\n\t\tSL_Hemisphere_Code,\n\t\tSL_Hemisphere_Desc,\n\t\tSub_Geomarket_Code,\n\t\tSubAccnt_Minor,\n\t\tYear,\n\t\tMonth,\n\t\tERP_Data,\n\t\tERP_UID_SPEND,\n\t\tERP_UID_ZEROIZATION,\n\t\tNIS_Sub_Line,\n\t\tERP_UID,\n\t\tFacility_ID,\n\t\tFacility_Name,\n\t\tFacility_Status,\n\t\tFacility_Type,\n\t\tFacility_Owner,\n\t\tLatitude,\n\t\tLongitude,\n\t\tOrigin_Business,\n\t\tBusiness_Activity,\n\t\tERP = ConditionalSplit1@FDECountryNA@ERP,\n\t\tFDE_City,\n\t\tLand_Area_Square_Meter,\n\t\tBuild_Area_Square_Meter,\n\t\tAccount_Type,\n\t\tFacility_Assigned,\n\t\tSubAccount,\n\t\tLocal,\n\t\tDocument_Number,\n\t\tGL_DATE,\n\t\tOperator,\n\t\tURN,\n\t\tSource_System,\n\t\tBusiness_Line,\n\t\tSub_Sub_Product_Line_Code,\n\t\tUpdateDate,\n\t\tSeqTrnsNbr,\n\t\tActivity,\n\t\tReference,\n\t\tYearMonth,\n\t\tGL_Description,\n\t\tDataFor,\n\t\tLast_Refreshed,\n\t\t{Nis Description},\n\t\tFDE_Country = {FDE-Country}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelRemoveJoinFieldsNonFacMapping\nConditionalSplit1@FDECountryNA, SrcNonFacMapping exists(ConditionalSplit1@FDECountryNA@ERP == SrcNonFacMapping@ERP\n\t&& CCAU == AUCC,\n\tnegate:true,\n\tbroadcast: 'auto')~> ExsNonFacMapping\nDerColConverttoInt split(FDE_Country == 'N/A',\n\tFDE_Country != 'N/A',\n\tdisjoint: true) ~> ConditionalSplit1@(FDECountryNA, FDECountryNonNA)\nDerColDataForField, ConditionalSplit1@FDECountryNonNA, ExsNonFacMapping, SelRemoveJoinFieldsNonFacMapping union(byName: true)~> UnAllInputs\nUnAllInputs sort(desc(DataFor, true),\n\tasc(YearMonth, true)) ~> SrtbyDataForandYearMonth\nSrtbyDataForandYearMonth select(mapColumn(\n\t\tFacility_ID,\n\t\tFacility_Name,\n\t\tFacility_Status,\n\t\tFacility_Type,\n\t\tFacility_Owner,\n\t\tLatitude,\n\t\tLongitude,\n\t\tOrigin_Business,\n\t\tBusiness_Activity,\n\t\tERP,\n\t\tSL_Hemisphere = SL_Hemisphere_Code,\n\t\tSL_Area = SL_Area_Code,\n\t\tSL_Geomarket = SL_Geomarket_Code,\n\t\tSub_Geomarket_Code,\n\t\tProduct_Line = Product_Line_Code,\n\t\tMgmt_Country_Code,\n\t\tERP_UID_SPEND,\n\t\tERP_UID_ZEROIZATION,\n\t\tFDE_Country,\n\t\tFDE_City,\n\t\tDataFor,\n\t\tTranAmount,\n\t\tBaseAmount,\n\t\tVendorVname,\n\t\tVendor,\n\t\tCurrencyCode,\n\t\tSystem,\n\t\tSourceCode,\n\t\tPoNumber,\n\t\tInvoiceNo,\n\t\tPostingDate,\n\t\tJournal,\n\t\tDescription,\n\t\tLineNbr,\n\t\tCompany_Desc,\n\t\tCompany,\n\t\tCountryDesc,\n\t\tAccount,\n\t\tAccountDesc,\n\t\tProfit_Center,\n\t\tCCAU,\n\t\tCCAUDesc,\n\t\tProduct_Line_Group_Code,\n\t\tSL_Product_Line = SL_Product_Line_Code,\n\t\tSL_Product_Line_Group_Code,\n\t\tSL_Sub_Product_Line = SL_Sub_Product_Line_Code,\n\t\tSub_Product_Line = Sub_Product_Line_Code,\n\t\tHemisphere_Desc = SL_Hemisphere_Desc,\n\t\tSubAccnt_Minor,\n\t\tYear,\n\t\tMonth,\n\t\tNIS_Sub_Line,\n\t\tERP_UID,\n\t\tLand_Area_Square_Meter,\n\t\tBuild_Area_Square_Meter,\n\t\tAccount_Type,\n\t\tFacility_Assigned,\n\t\tSubAccount,\n\t\tLocal,\n\t\tDocument_Number,\n\t\tGL_DATE,\n\t\tOperator,\n\t\tURN,\n\t\tSource_System,\n\t\tBusiness_Line,\n\t\tSub_Sub_Product_Line_Code,\n\t\tUpdateDate,\n\t\tSeqTrnsNbr,\n\t\tActivity,\n\t\tReference,\n\t\tYearMonth,\n\t\tGL_Description,\n\t\tLast_Refreshed,\n\t\tNis_Description = {Nis Description}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelFInalColumns\nSelFInalColumns sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tCCAU as string,\n\t\tCCAUDesc as string,\n\t\tAccount as string,\n\t\tSubAccount as string,\n\t\tAccountDesc as string,\n\t\tYear as integer,\n\t\tMonth as integer,\n\t\tActivity as string,\n\t\tSourceCode as string,\n\t\tSystem as string,\n\t\tJournal as string,\n\t\tLineNbr as string,\n\t\tOperator as string,\n\t\tReference as string,\n\t\tDescription as string,\n\t\tCurrencyCode as string,\n\t\tTranAmount as string,\n\t\tBaseAmount as string,\n\t\tVendor as string,\n\t\tVendorVname as string,\n\t\tPoNumber as string,\n\t\tInvoiceNo as string,\n\t\tURN as string,\n\t\tSL_Area as string,\n\t\tSL_Geomarket as string,\n\t\tMgmt_Country_Code as string,\n\t\tSL_Hemisphere as string,\n\t\tHemisphere_Desc as string,\n\t\tSL_Product_Line as string,\n\t\tSL_Sub_Product_Line as string,\n\t\tProduct_Line as string,\n\t\tSub_Product_Line as string,\n\t\tCompany as string,\n\t\tCompany_Desc as string,\n\t\tERP_UID_SPEND as string,\n\t\tERP_UID_ZEROIZATION as string,\n\t\tNIS_Sub_Line as string,\n\t\tERP as string,\n\t\tFacility_Assigned as string,\n\t\tERP_UID as string,\n\t\tFacility_ID as string,\n\t\tFacility_Name as string,\n\t\tFacility_Status as string,\n\t\tFacility_Type as string,\n\t\tFacility_Owner as string,\n\t\tFDE_Country as string,\n\t\tFDE_City as string,\n\t\tLatitude as double,\n\t\tLongitude as double,\n\t\tOrigin_Business as string,\n\t\tBusiness_Activity as string,\n\t\tAccount_Type as string,\n\t\tLocal as string,\n\t\tProfit_Center as string,\n\t\tBusiness_Line as string,\n\t\tYearMonth as date,\n\t\tGL_Description as string,\n\t\tDataFor as string,\n\t\tNIS_Description as string,\n\t\tSL_Product_Line_Group_Code as string,\n\t\tProduct_Line_Group_Code as string,\n\t\tUpdateDate as date,\n\t\tPostingDate as date,\n\t\tGL_DATE as date,\n\t\tSeqTrnsNbr as string,\n\t\tDOCUMENT_NUMBER as string,\n\t\tSOURCE_SYSTEM as string,\n\t\tCountryDesc as string,\n\t\tSub_Geomarket_Code as string,\n\t\tSub_Sub_Product_Line_Code as string,\n\t\tSubAccnt_Minor as string,\n\t\tLand_Area_Square_Meter as decimal(24,0),\n\t\tBuild_Area_Square_Meter as decimal(24,0),\n\t\tLast_Refreshed as timestamp\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\ttruncate:true,\n\tformat: 'table',\n\tstaged: true,\n\tallowCopyCommand: true,\n\tpreSQLs:['\\nDELETE FROM [NGBS_FI].[TF_FFAC_Facilities_PnL_temp]\\nWHERE [DataFor] = \\'Mapping\\''],\n\tpostSQLs:['\\nDELETE FROM [NGBS_FI].[TF_FFAC_Facilities_PnL_temp] \\nWHERE EXISTS \\n(SELECT Year, Month, ERP FROM [NGBS_FI].[stg_TF_FFAC_Facilities_PnL_temp] stg \\nWHERE [NGBS_FI].[TF_FFAC_Facilities_PnL_temp].Year = stg.Year AND \\n[NGBS_FI].[TF_FFAC_Facilities_PnL_temp].Month = stg.Month AND \\n[NGBS_FI].[TF_FFAC_Facilities_PnL_temp].ERP = stg.ERP)\\n\\n\\nINSERT INTO [NGBS_FI].[TF_FFAC_Facilities_PnL_temp] \\nSELECT * FROM [NGBS_FI].[stg_TF_FFAC_Facilities_PnL_temp]'],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError',\n\toutputRejectedData: true,\n\trejectedData_fileSystem: 'test',\n\tmapColumn(\n\t\tCCAU,\n\t\tCCAUDesc,\n\t\tAccount,\n\t\tSubAccount,\n\t\tAccountDesc,\n\t\tYear,\n\t\tMonth,\n\t\tActivity,\n\t\tSourceCode,\n\t\tSystem,\n\t\tJournal,\n\t\tLineNbr,\n\t\tOperator,\n\t\tReference,\n\t\tDescription,\n\t\tCurrencyCode,\n\t\tTranAmount,\n\t\tBaseAmount,\n\t\tVendor,\n\t\tVendorVname,\n\t\tPoNumber,\n\t\tInvoiceNo,\n\t\tURN,\n\t\tSL_Area,\n\t\tSL_Geomarket,\n\t\tMgmt_Country_Code,\n\t\tSL_Hemisphere,\n\t\tHemisphere_Desc,\n\t\tSL_Product_Line,\n\t\tSL_Sub_Product_Line,\n\t\tProduct_Line,\n\t\tSub_Product_Line,\n\t\tCompany,\n\t\tCompany_Desc,\n\t\tERP_UID_SPEND,\n\t\tERP_UID_ZEROIZATION,\n\t\tNIS_Sub_Line,\n\t\tERP,\n\t\tFacility_Assigned,\n\t\tERP_UID,\n\t\tFacility_ID,\n\t\tFacility_Name,\n\t\tFacility_Status,\n\t\tFacility_Type,\n\t\tFacility_Owner,\n\t\tFDE_Country,\n\t\tFDE_City,\n\t\tLatitude,\n\t\tLongitude,\n\t\tOrigin_Business,\n\t\tBusiness_Activity,\n\t\tAccount_Type,\n\t\tLocal,\n\t\tProfit_Center,\n\t\tBusiness_Line,\n\t\tYearMonth,\n\t\tGL_Description,\n\t\tDataFor,\n\t\tNIS_Description = Nis_Description,\n\t\tSL_Product_Line_Group_Code,\n\t\tProduct_Line_Group_Code,\n\t\tUpdateDate,\n\t\tPostingDate,\n\t\tGL_DATE,\n\t\tSeqTrnsNbr,\n\t\tDOCUMENT_NUMBER = Document_Number,\n\t\tSOURCE_SYSTEM = Source_System,\n\t\tCountryDesc,\n\t\tSub_Geomarket_Code,\n\t\tSub_Sub_Product_Line_Code,\n\t\tSubAccnt_Minor,\n\t\tLand_Area_Square_Meter,\n\t\tBuild_Area_Square_Meter,\n\t\tLast_Refreshed\n\t)) ~> SnkStgFFACFacilitiesTemp"
		}
	}
}